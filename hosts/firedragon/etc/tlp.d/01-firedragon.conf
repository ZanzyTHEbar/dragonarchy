# FireDragon TLP Configuration - AMD Laptop Optimized
# Updated to fix suspend/resume issues

# CPU Energy Performance Policies
CPU_ENERGY_PERF_POLICY_ON_AC=balance_performance
CPU_ENERGY_PERF_POLICY_ON_BAT=balance_power

# AMD P-State EPP (Energy Performance Preference)
CPU_BOOST_ON_AC=1
CPU_BOOST_ON_BAT=1

# CPU Min/Max Performance
CPU_MIN_PERF_ON_AC=0
CPU_MAX_PERF_ON_AC=100
CPU_MIN_PERF_ON_BAT=0
CPU_MAX_PERF_ON_BAT=80

# AMD Radeon GPU Power Management
# CRITICAL FIX: Don't force GPU state during suspend/resume
# Let amdgpu driver handle power states automatically
RADEON_DPM_PERF_LEVEL_ON_AC=auto
RADEON_DPM_PERF_LEVEL_ON_BAT=auto
RADEON_DPM_STATE_ON_AC=performance
RADEON_DPM_STATE_ON_BAT=battery
RADEON_POWER_PROFILE_ON_AC=default
RADEON_POWER_PROFILE_ON_BAT=auto

# Platform Profile
PLATFORM_PROFILE_ON_AC=balanced
PLATFORM_PROFILE_ON_BAT=balanced

# WiFi Power Saving
WIFI_PWR_ON_AC=off
WIFI_PWR_ON_BAT=auto

# PCIe Active State Power Management
PCIE_ASPM_ON_AC=default
PCIE_ASPM_ON_BAT=default

# USB Auto-suspend
USB_AUTOSUSPEND=1
USB_EXCLUDE_AUDIO=1
# AX210 BT (8087:0032): keep btusb devices out of autosuspend to avoid HCI reset timeouts -> BlueZ NotReady
USB_EXCLUDE_BTUSB=1
USB_EXCLUDE_PHONE=0
USB_EXCLUDE_PRINTER=1
USB_EXCLUDE_WWAN=0

# Runtime Power Management
# CRITICAL FIX: Use 'auto' for both AC and battery to let kernel manage properly
RUNTIME_PM_ON_AC=auto
RUNTIME_PM_ON_BAT=auto

# Battery thresholds (if supported)
START_CHARGE_THRESH_BAT0=75
STOP_CHARGE_THRESH_BAT0=80

# Disk settings
DISK_DEVICES="nvme0n1"
DISK_APM_LEVEL_ON_AC="254 254"
DISK_APM_LEVEL_ON_BAT="128 128"

# SATA link power management
SATA_LINKPWR_ON_AC="med_power_with_dipm max_performance"
SATA_LINKPWR_ON_BAT="min_power"

# Audio power saving
SOUND_POWER_SAVE_ON_AC=0
SOUND_POWER_SAVE_ON_BAT=1
SOUND_POWER_SAVE_CONTROLLER=Y

# CRITICAL FIX: Restore devices on wakeup
# Ensure TLP doesn't prevent GPU from waking up properly
RESTORE_DEVICE_STATE_ON_STARTUP=1

