#!/bin/bash
# Toggles the hypridle daemon on and off, with a desktop notification.

set -euo pipefail

HYPRIDLE_CFG="${XDG_CONFIG_HOME:-$HOME/.config}/hypr/config/hypridle.conf"

if pgrep -x hypridle >/dev/null 2>&1; then
  pkill -x hypridle || true
  command -v notify-send >/dev/null 2>&1 && notify-send -a "Idle" "Idle Inhibited" "Computer will not lock when idle."
else
  # Relaunch hypridle with our config via uwsm
  uwsm app -- hypridle -c "$HYPRIDLE_CFG" >/dev/null 2>&1 &
  disown || true
  command -v notify-send >/dev/null 2>&1 && notify-send -a "Idle" "Idle Enabled" "Computer will now lock when idle."
fi
